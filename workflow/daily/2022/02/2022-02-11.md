# 2022-02-11

- relate doc
    - [[linux]]
    - [[mount]]

#linux/mount automatically mount usb drive

- 取得drive UUID
  - 使用blkid查詢 設備資訊
  - 使用awk截取字串
    - 原始資訊： /dev/sdb1: UUID="xx-xx-xx-xx-xx" BLOCK_SIZE="4096" TYPE="ext4" PARTLABEL="My Passport" PARTUUID="xx-xx-xx-xx-xx"
    - '{print $2}' 預設分隔符號為space，取出第2個欄位 UUID="xx-xx-xx-xx-xx-xx"
        > 結果為 UUID="xx-xx-xx-xx-xx"
    - -F'"' '{print $2}' 加入-F 指定分隔符號`"`，以"拆分字串
        > 拆分後第一個欄位值為 /dev/sdb1: UUID=",第2個欄位為xx-xx-xx-xx-xx

````bash
sudo blkid /dev/sdb1 | awk -F '"' '{print $2}'
````

-取得UUID後，修改`/etc/fstab`
    - 第一個欄位為drive UUID
    - 第二個欄位為掛載位置
    - 第三個欄位為drive 檔案類型
    - 第四個欄位為default，含(rw，exec，auto，nouser，async等)，詳細看fstab table structure說明
    - backup operation
    - File System Check Order

````bash
sudo vim /etc/fstab
````

````content
UUID=xx-xx-xx-xx-xx /media etx4 defaults 0 0
````

## fstab

Table structure

- The table itself is a 6 column structure, where each column designates a specific parameter and must be set up in the correct order. The columns of the table are as follows from left to right: 
    - Device: usually the given name or UUID of the mounted device (sda1/sda2/etc).
    - Mount Point: designates the directory where the device is/will be mounted. 
    - File System Type: nothing trick here, shows the type of filesystem in use. 
    - Options: lists any active mount options. If using multiple options they must be separated by commas. 
    - Backup Operation: (the first digit) this is a binary system where 1 = dump utility backup of a partition. 0 = no backup. This is an outdated backup method and should NOT be used. 
    - File System Check Order: (second digit) Here we can see three possible outcomes.  0 means that fsck will not check the filesystem. Numbers higher than this represent the check order. The root filesystem should be set to 1 and other partitions set to 2. 

## 參考連結

- [auto mount flash drive at startup](https://askubuntu.com/questions/683034/how-to-automatically-mount-usb-flash-drive-at-startup)
- [掛載隨身碟](https://blog.xuite.net/beavisliu/blog/15341561)
- [grep & awk](https://ithelp.ithome.com.tw/articles/10136126)
- [introduction akw](https://dywang.csie.cyut.edu.tw/dywang/linuxProgram/node50.html)
- [awk -F](https://blog.csdn.net/liangbilin/article/details/108593296)
- [introduction /etc/fstab](https://www.redhat.com/sysadmin/etc-fstab)

[//begin]: # "Autogenerated link references for markdown compatibility"
[linux]: ../../../../devops/7-operate/learning/env/linux/linux.md "Linux"
[mount]: ../../../../devops/7-operate/learning/env/linux/mount.md "mount"
[//end]: # "Autogenerated link references"
