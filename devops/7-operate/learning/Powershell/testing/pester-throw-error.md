# Pester Throw Error
[[pester]]
1. You could change it so that it throws a terminating error by changing your Write-Error to Throw.

2. You could change the test to force the function to throw a terminating error even when non-terminating ones occur by using -ErrorAction Stop when you invoke it (I can see you're using -Confirm, I assume you have used [cmdletbinding()] in the function to add the common parameters like -ErrorAction).

```powershell
Function Remove-GenericCredential {
    [cmdletbinding(supportsshouldprocess)]
    Param(
        $InternetOrNetworkAddress
    )

    Write-Error "Remove-GenericCredential : Credential $InternetOrNetworkAddress not found"
}

Describe "Remove-GenericCredential Function Tests" {
    $InternetOrNetworkAddress = 'https://PesterTestUser@PesterTestURl.com'

    Context "Test:  Remove-GenericCredential -InternetOrNetworkAddress '$InternetOrNetworkAddress' (Credential does not exist)" {
    It "This Command threw an error.  The credential does not exist." { 
        { (Remove-GenericCredential -InternetOrNetworkAddress $InternetOrNetworkAddress -Confirm:$false -ErrorAction Stop) } | should throw "Remove-GenericCredential : Credential $InternetOrNetworkAddress not found" }
    }
}
```

## 個人練習

- ps1
```powershell
if(($null -eq $ComputerName))
{
    Write-Error -Message "$ComputerNameErrorMessage" -ErrorAction Stop
}
```

- Tests.ps1
```powershell
 Context "Parameter Values,Validations and Errors" {
        It "given null Server Address, it should be return Error" {
            {Test-Port} | Should -Throw "Server address must be have value"
        }

        It "given empty value, it should be return Error" {
            {Test-Port -ComputerName @()} | Should -Throw "Server address must be have value"
        }
    }
```

## 參考資源

[msdn](https://docs.microsoft.com/zh-tw/powershell/scripting/learn/deep-dives/everything-about-exceptions?view=powershell-7.1)
[links](https://stackoverflow.com/questions/49181479/pester-doesnt-catch-the-thrown-error)

[//begin]: # "Autogenerated link references for markdown compatibility"
[pester]: ../../../../develop/language/Powershell/testing/pester.md "Pester"
[//end]: # "Autogenerated link references"